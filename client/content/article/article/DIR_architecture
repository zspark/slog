# 什么是DIR
DIR（Data Instance Relation）的首字母

# Data
数据部分是可以共享的，这应该是DIR架构中D部分的核心思想。数据可以是以任何形式存在或者提供的：磁盘、网络流、IO设备、动态生成 etc. 因此数据具有异构的特性，异构数据如何在程序中以相同的逻辑操作，我们使用`数据代理`。

## 数据代理

数据一般以`数据代理`的方式实现，在程序的静态结构设计上，代理层不应该被动态的添加或者删除，而是应该作为固定的逻辑而存在。可以使用不同的实现（或者他们的组合）去代理不同的行为：
1. 空代理：直接对数据进行转发或者修改的代理，比如结构体中的数据可以由该代理实时改变、磁盘流可以由该代理及时读写、网络流可以立即发送;
2. 线程安全的代理：对被代理数据的操作需要在线程安全的情况下进行;
2. 权限的代理：不同的代理对数据的操作有不同的权限（只读、不可删 etc.）;
3. 延迟性代理：对网络这种有一定延迟性的数据，可用该代理缓存;

对数据的操作，有2种模式：
* 及时共享：共享的数据会第一时间分享给所有共享他的实例;
* 操作共享：一但共享的数据变化，会创建全新的数据副本，不影响其他共享者;


# Instance
实例部分是绝对不能共享的，是独立表征功能与业务逻辑的实体，在架构的设计中，即使多个实例具有“完全一致”的属性与逻辑，也需要多个instance来唯一表示。

实例共享数据，也拥有对数据的增删改查权利，那么就需要考虑下面的情况：

### 变动数据对其他使用者的伤害
我们可以通过代理数据的方式避免该问题的出现，简单而言就是在真实数据与实例之间多一层“代理”，该代理被各个实例所持有，而代理不会被实例销毁。

### 线程安全
同样，我们可以对上面的代理层增加线程安全的逻辑。不选择在实例里面加入是因为我们对“实例”的定位是独立的、处理功能与|或业务逻辑的逻辑组件。


# Relation
关系部分表征的是实例之间的外在可见性。每个实例不可能独立存在于应用之中，其任何外部可见性属性皆属于Relation部分。

Relation可以有静态与动态关系。静态关系诸如类的继承关系，成员属性;动态关系比如树中节点的变动，数组的内容等。
